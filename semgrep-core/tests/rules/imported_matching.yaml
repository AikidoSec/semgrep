rules:
- id: my_pattern_id
  pattern-either:
    - pattern: |
        res1 = $X
        ...
        def $FUNC(...):
          return $X 
    - patterns:
        - pattern: |
            ...
            res1 = A.$X
        - focus-metavariable: $X
    - patterns:
        - pattern: |
            ...
            res2 = $B.y
        - focus-metavariable: $B
  message: |
    We do not want a match here. This rule is looking for `foo` being called on an identifier
    which does not start with `_`, which clearly `_y` does.
    Unfortunately, because of our matching logic, we decide to produce a match to both the
    identifier, and the resolved name. So we flag this, even though in intention it isn't
    faithful. 
  severity: WARNING
  languages: [python]
