rules:
  - id: secrets
    message: "found use of secret"
    languages: [python]
    severity: WARNING
    mode: step
    steps:
        - languages: [python]
          patterns:
          - pattern: |
                register_secret($X)
        - languages: [python]
          mode: taint
          pattern-sources:
          - pattern: |
                $X
          pattern-sinks:
          - pattern: |
                logger.log(...)